# 🚀 Telegram 个人消息转发机器人 (V4)

## ✨ 功能特性

* **✉️ 全能消息转发**: 支持转发所有类型的消息，包括文本、图片、视频、贴纸、文件等。
* **↩️ 便捷回复功能**: 只需对机器人转发的消息使用 "回复" 功能，即可将你的回复（任何类型）发送给原始用户。
* **💾 持久化会话**: 机器人重启或服务器宕机后，依然可以回复之前的旧消息，不会丢失对话上下文。
* **🔐 安全可靠**: 敏感信息（Bot Token 和 Owner ID）通过外部配置文件管理，不暴露在代码中。
* **🎨 美观的 UI**: 经过精心设计的消息格式，信息清晰，重点突出，交互友好。
* **⚙️ 管理功能**: 为机器人主人提供了 **/clear** **命令，用于一键清除所有消息的回复缓存。**
* **🚀 部署简单**: 提供了详细的部署指南，支持多种后台运行方式。
---------------------------------------------------------

## 🔧 部署指南

**请遵循以下步骤在你的 VPS上部署此机器人。**

### 1. 准备工作

**在开始之前，请确保你已经拥有：**

* **一台可以访问 Telegram API 的 VPS。**
* **在 VPS 上安装了 Python 3.8+。**
* **一个 Telegram 账号。**

### 2. 获取 Telegram 必要凭证

你需要从 Telegram 获取两样东西：

* **Bot Token** **(机器人令牌)**
  
  * 在 Telegram 上搜索 **```BotFather```** 并开始对话。
  * 发送 **```/newbot```** 命令。
  * 按照提示为你的机器人设置一个名字和用户名（用户名必须以 **```bot```** 结尾）。
  * ​```BotFather``` 会给你一串 Token，形如 **```123456:ABC-DEF1234ghIkl-zyx57W2v1u123456789```**。请妥善保管它。
* **Owner ID** **(你的用户ID)**
* 在 Telegram 上搜索 **```userinfobot```** 并开始对话。
* 它会立刻返回你的个人信息，其中的 **```Id:```** 就是你的 **```Owner ID```**。这是一个纯数字。

## 3. 部署步骤

#### 第 1 步：克隆仓库并安装依赖

**连接到你的 VPS 终端，执行以下命令。**

> # 1. 克隆本仓库
> 
> git clone https://github.com/nccttc/Telegram-/blob/main/forwarder_bot_v4.py
> 
> # 2. 进入项目目录
> 
> cd forwarder_bot_v4.py
> 
> # 3.创建并激活 Python 虚拟环境
> 
> 
> 
> 
> python3 -m venv venv
> source venv/bin/activate
> 
> >
> 
> 
> # 4. 安装所需的库
> 
> 
> 
> 
> pip install python-telegram-bot --upgrade

#### 第 2 步：配置机器人

1. 项目根目录下有一个 **```config.ini.example```** 文件。请复制一份并重命名为 **```config.ini```**。
   
   > cp config.ini.example config.ini

2. 编辑 **```config.ini```** 文件，填入你在```准备工作```中获取到的凭证。
   
   > [Telegram]
   > BOT_TOKEN = 123456:ABC-DEF1234ghIkl-zyx57W2v1u123456789
   > OWNER_ID = 123456789

#### 第 3 步：启动机器人

你可以先在前台启动来测试机器人是否配置正确。

> python3 forwarder_bot_v4.py

此时，你的机器人应该已经在线。你可以用你的主人账号给机器人发送 **```/start```**，应该会收到管理员专属欢迎语。同时，你的管理员账号也会收到一条"机器人已启动"的通知。


#### 第 4 步：让机器人在后台永久运行 (生产环境)

为了让机器人在你关闭 SSH 连接后依然能 7x24 小时运行，你需要使用进程管理器。这里推荐两种方法：

> 1. 创建一个名为 "telegram\_bot" 的 screen 会话 screen -S telegram\_bot
>    `screen -S telegram_bot`

> 2. 在新的会话窗口中，启动机器人 (如果使用了虚拟环境，请先激活)
>    `source venv/bin/activate`
>    `python3 forwarder_bot_v4.py`

> 3. 按下 Ctrl + A 然后再按 D，即可安全离开会话。机器人会继续在后台运行。
>    若要返回会话，使用 `screen -r telegram_bot`

---

# 部署完成！

## 📚 使用说明

### 普通用户

* **找到你的机器人。**
* **直接发送任何类型的消息（文本、图片、文件等）。**
* **消息将被自动转发给机器人主人，并收到确认回执。**

### 机器人主人 (Owner)

* ​**接收消息**: 用户消息会被自动转发给你，并附带用户信息。 ​
* ​**回复消息**: 在 Telegram 中，对机器人转发的任意一条消息使用“回复”功能，你的回复内容将被自动发送给原始用户。 ​
  
  > * **命令**:
  > * **/start**: 查看欢迎信息。
  > * **/help**: 获取帮助。
  > * **/clear**: 清除所有消息的回复记录。这不会删除聊天记录，只会让机器人“忘记”如何回复旧消息。
